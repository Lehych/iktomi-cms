<div class="wysihtml5-widget {% if widget.classname %} {{ widget.classname }}{% endif %}">
  <div id="{{ widget.id }}-toolbar" class="wysihtml5-toolbar" style="display: none;">
    {% if widget.has_button('bold') %}
    <a data-wysihtml5-command="bold" class="btn">Полужирный</a>
    {% endif %}
    {% if widget.has_button('italic') %}
    <a data-wysihtml5-command="italic" class="btn">Курсив</a>
    {% endif %}
    {% if widget.has_button('underline') %}
    <a data-wysihtml5-command="underline" class="btn">Подчеркнутый</a>
    {% endif %}

    {% if widget.block_exists('headings', 'sup', 'sup', 'blockquote') %}
    <span class="separator"></span>
    {% endif %}

    {% if widget.has_button('headings') %}
    <a data-wysihtml5-command="headings" class="btn">Заголовок</a>
    <div class="wysihtml5-dialog-place">
      <div class="wysihtml5-dialog wysihtml5-menu"
           data-wysihtml5-dialog="headings" style="display: none;">
        {% if widget.has_button('h1') %}
        <a data-wysihtml5-command="h1">Заголовок 1</a>
        {% endif %}
        {% if widget.has_button('h2') %}
        <a data-wysihtml5-command="h2">Заголовок 2</a>
        {% endif %}
        {% if widget.has_button('h3') %}
        <a data-wysihtml5-command="h3">Заголовок 3</a>
        {% endif %}
        {% if widget.has_button('h4') %}
        <a data-wysihtml5-command="h4">Заголовок 4</a>
        {% endif %}
        <a data-wysihtml5-dialog-action="cancel">Закрыть</a>
      </div>
    </div>
    {% endif %}

    {% if widget.has_button('sup') %}
    <a data-wysihtml5-command="sup" class="btn">Верхний индекс</a>
    {% endif %}
    {% if widget.has_button('sub') %}
    <a data-wysihtml5-command="sub" class="btn">Нижний индекс</a>
    {% endif %}
    {% if widget.has_button('blockquote') %}
    <a data-wysihtml5-command="blockquote" class="btn">Цитата</a>
    {% endif %}

    {% if widget.block_exists('insertorderedlist', 'insertunorderedlist', 'outdent', 'indent') %}
    <span class="separator"></span>
    {% endif %}

    {% if widget.has_button('insertunorderedlist') %}
    <a data-wysihtml5-command="insertunorderedlist" class="btn">Список</a>
    {% endif %}
    {% if widget.has_button('insertorderedlist') %}
    <a data-wysihtml5-command="insertorderedlist" class="btn">Нумерованный список</a>
    {% endif %}
    {% if widget.has_button('outdent') %}
    <a data-wysihtml5-command="outdent" class="btn">Уменьшить отступ</a>
    {% endif %}
    {% if widget.has_button('indent') %}
    <a data-wysihtml5-command="indent" class="btn">Увеличить отступ</a>
    {% endif %}


    {% if widget.block_exists('createLink', 'insertImage', 'fileLink', 'extrachars', 'personLink') %}
    <span class="separator"></span>
    {% endif %}

    {% if widget.has_button('createLink') %}
    <a data-wysihtml5-command="createLink" class="btn">Вставить ссылку</a>
    <div class="wysihtml5-dialog-place">
      <div class="wysihtml5-dialog" data-wysihtml5-dialog="createLink" style="display: none;">
        <label>
          Ссылка:
          <input data-wysihtml5-dialog-field="href" value="http://" class="text">
        </label>
        <div style="white-space: nowrap">
          <a data-wysihtml5-dialog-action="save">Применить</a>
          <a data-wysihtml5-command="unlink">Удалить ссылку</a>
        </div>
        <a data-wysihtml5-dialog-action="cancel">Закрыть</a>
      </div>
    </div>
    {% endif %}

    {% if widget.has_button('insertImage') %}
    <a data-wysihtml5-command="insertImage" class="btn">Вставить изображение</a>
    <div class="wysihtml5-dialog-place">
      <div class="wysihtml5-dialog" data-wysihtml5-dialog="insertImage" style="display: none;">
        <label>
          Ссылка на изображение:
          <input data-wysihtml5-dialog-field="src" value="http://" class="text">
        </label>
        <br/>
        <a data-wysihtml5-dialog-action="save">Применить</a>
        <a data-wysihtml5-dialog-action="cancel">Закрыть</a>
      </div>
    </div>
    {% endif %}

    {% if widget.has_button('fileLink') %}
    <a data-wysihtml5-command="fileLink" class="btn">Вставить ссылку на файл</a>
    <div class="wysihtml5-dialog-place">
      <div class="w-popup-stream-select wysihtml5-dialog wysihtml5-menu" style="display: none" 
           id="{{ widget.id }}-filelink">
        <div class="w-buttons">
          <a data-wysihtml5-command="fileLink"
             data-wysihtml5-command-value="select">Выбрать файл</a>
          <a data-wysihtml5-command="fileLink"
            data-wysihtml5-command-value="create">Создать файл</a>
          <a data-wysihtml5-command="fileLink"
             data-wysihtml5-command-value="delete">Удалить ссылку</a>
          <a onclick="this.getParent('.wysihtml5-dialog').style.display = 'none'">Закрыть</a>
          <div style="display: none"> 
            <a id="{{ widget.id }}-filelink-btn"></a>
            <a id="{{ widget.id }}-filelink-create"></a>
            <table class="w-popup-stream-select-items">
              <tbody id="{{ widget.id }}-filelink-div"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    {% endif %}

    {% if widget.has_button('personLink') %}
    <a data-wysihtml5-command="personLink" class="btn">Вставить ссылку на персону</a>
    <div class="wysihtml5-dialog-place">
      <div class="w-popup-stream-select wysihtml5-dialog wysihtml5-menu" style="display: none" 
           id="{{ widget.id }}-personlink">
        <div class="w-buttons">
          <a data-wysihtml5-command="personLink"
             data-wysihtml5-command-value="select">Выбрать персону</a>
          <a data-wysihtml5-command="personLink"
            data-wysihtml5-command-value="create">Создать персону</a>
          <a data-wysihtml5-command="personLink"
             data-wysihtml5-command-value="delete">Удалить ссылку</a>
          <a onclick="this.getParent('.wysihtml5-dialog').style.display = 'none'">Закрыть</a>
          <div style="display: none"> 
            <a id="{{ widget.id }}-personlink-btn"></a>
            <a id="{{ widget.id }}-personlink-create"></a>
            <table class="w-popup-stream-select-items">
              <tbody id="{{ widget.id }}-personlink-div"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    {% endif %}

    {% if widget.has_button('table') %}
    <a data-wysihtml5-command="table" class="btn">Вставить таблицу</a>
    <div class="wysihtml5-dialog-place">
      <div class="wysihtml5-dialog"  data-wysihtml5-dialog="table"
           id="{{ widget.id }}-table" style="display: none; min-width:150px">
        <label style="display: inline-block; width: 75px">
          Столбцы:
        </label>
        <input data-wysihtml5-dialog-field="cols" value="2" class="text" size="3">
        <br/>
        <label style="display: inline-block; width: 75px">
          Строки:
        </label>
        <input data-wysihtml5-dialog-field="rows" value="2" class="text" size="3">

        <br/>
        <a data-wysihtml5-dialog-action="save">ОК</a>
        <a data-wysihtml5-dialog-action="cancel">Закрыть</a>
      </div>
    </div>
    <div class="wysihtml5-dialog-place">
      <div class="wysihtml5-dialog wysihtml5-menu"
           id="{{ widget.id }}-table-buttons" style="display: none">
          <!--a data-wysihtml5-command="moveToNextRow">Переместиться к следующей строке</a-->
          <!--a data-wysihtml5-command="splitCells">Разделить ячейку</a>
          <a data-wysihtml5-command="mergeCells">Объединить ячейки</a-->
          <a data-wysihtml5-command="insertRowBefore">Добавить строку до</a>
          <a data-wysihtml5-command="insertRowAfter">Добавить строку после</a>
          <a data-wysihtml5-command="deleteRow">Удалить строку</a>
          <hr/>
          <a data-wysihtml5-command="insertColBefore">Добавить столбец до</a>
          <a data-wysihtml5-command="insertColAfter">Добавить столбец после</a>
          <a data-wysihtml5-command="deleteCol">Удалить столбец</a>
          <hr/>
          <a data-wysihtml5-command="cutRow">Вырезать строку</a>
          <a data-wysihtml5-command="copyRow">Копировать строку</a>
          <a data-wysihtml5-command="pasteRowBefore">Вставить строку до</a>
          <a data-wysihtml5-command="pasteRowAfter">Вставить строку после</a>
          <hr/>
          <a data-wysihtml5-command="deleteTable">Удалить таблицу</a>
          <hr/>
          <a onclick="this.getParent('.wysihtml5-dialog').style.display = 'none'">Закрыть</a>
      </div>
    </div>
    {% endif %}

    {% if widget.has_button('extrachars') %}
    <a data-wysihtml5-command="extrachars" class="btn">Специальные символы</a>
    <div class="wysihtml5-dialog-place">
      <div class="wysihtml5-dialog" data-wysihtml5-dialog="extrachars"
        style="display: none; width: 230px; left: -110px">
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="—"
           class="wysihtml5-char">—</a>
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="–"
           class="wysihtml5-char">–</a>
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="±"
           class="wysihtml5-char">±</a>
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="…"
           class="wysihtml5-char">…</a>
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="«"
           class="wysihtml5-char">«</a>
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="»"
           class="wysihtml5-char">»</a>
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="©"
           class="wysihtml5-char">©</a>
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="™"
           class="wysihtml5-char">™</a>
        <a data-wysihtml5-command="insertHTML" data-wysihtml5-command-value="&nbsp;"
           class="wysihtml5-char">неразрывный пробел</a>
        <br/>
        <a style="float: right" onclick="this.getParent('.wysihtml5-dialog').style.display = 'none'">Закрыть</a>
      </div>
    </div>
    {% endif %}

    <span class="separator"></span>

    <a data-wysihtml5-command="undo" class="btn disabled">Отменить</a>
    <a data-wysihtml5-command="redo" class="btn disabled">Повторить</a>

    {% if widget.block_exists('html') %}
    <span class="separator"></span>
    {% endif %}

    {% if widget.has_button('html') %}
    <a data-wysihtml5-action="change_view" title="Show HTML" class="btn"></a>
    {% endif %}

    <div style="clear: both"></div>
  </div>
  
  <textarea id="{{ widget.id }}"  name="{{ widget.input_name }}"
    class="init-block wysihtml5"
    data-block-name="wysihtml5" data-config="{{ widget.js_config|forceescape }}">
    {{- value|forceescape }}
  </textarea>
</div>

<script>
  wysihtml5Init('{{ widget.id }}');
</script>
